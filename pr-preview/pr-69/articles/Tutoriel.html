<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="fr">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title> • sndsTools</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sndsTools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/benchmark_dplyr_vs_rsql.html">Benchmarking dplyr vs RSQL</a></li>
    <li><a class="dropdown-item" href="../articles/contribuer.html">Contribuer</a></li>
    <li><a class="dropdown-item" href="../articles/gouvernance.html">Gouvernance</a></li>
    <li><a class="dropdown-item" href="../articles/paresnds.html">Prise en main</a></li>
    <li><a class="dropdown-item" href="../articles/Tutoriel.html">UNKNOWN TITLE</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SNDStoolers/sndsTools" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1></h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/SNDStoolers/sndsTools/tree/main/vignettes/Tutoriel.Rmd" class="external-link"><code>vignettes/Tutoriel.Rmd</code></a></small>
      <div class="d-none name"><code>Tutoriel.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="tutoriel-cas-détude">Tutoriel : cas d’étude<a class="anchor" aria-label="anchor" href="#tutoriel-cas-d%C3%A9tude"></a>
</h2>
<p>Ceci est un tutoriel illustrant une utilisation de <a href="../R/"><code>sndsTools</code></a> dans le cadre d’une étude
fictive sur l’analyse des médicaments antihypertenseurs.</p>
<div class="section level3">
<h3 id="contexte-de-létude">Contexte de l’étude<a class="anchor" aria-label="anchor" href="#contexte-de-l%C3%A9tude"></a>
</h3>
<p>Dans le cadre de cette étude, nous souhaitons analyser la
consommation de médicaments antihypertenseurs chez les patients du SNDS.
Nous allons extraire les données pertinentes en utilisant les fonctions
disponibles dans <a href="../R/"><code>sndsTools</code></a>, effectuer
des analyses descriptives et présenter les résultats.</p>
<p>Les objectifs de cette étude sont : 1. Identifier les patients avec
des délivrances d’antihypertenseurs 2. Analyser les Affections de Longue
Durée (ALD) cardiovasculaires associées 3. Étudier les séjours
hospitaliers en lien avec l’hypertension 4. Effectuer des analyses
descriptives sur ces populations</p>
</div>
<div class="section level3">
<h3 id="prérequis">Prérequis<a class="anchor" aria-label="anchor" href="#pr%C3%A9requis"></a>
</h3>
<p>Avant de commencer, assurez-vous d’avoir : - Une connexion à la base
de données Oracle du SNDS - Le package <a href="../R/"><code>sndsTools</code></a> installé et chargé - Les
autorisations nécessaires pour accéder aux données</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Charger les packages nécessaires</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sndstoolers.github.io/sndsTools/index.html/" class="external-link">sndsTools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Établir la connexion à la base de données</span></span>
<span><span class="va">conn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/connect_oracle.html">connect_oracle</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="étape-1-extraction-des-délivrances-dantihypertenseurs">Étape 1 : Extraction des délivrances d’antihypertenseurs<a class="anchor" aria-label="anchor" href="#%C3%A9tape-1-extraction-des-d%C3%A9livrances-dantihypertenseurs"></a>
</h3>
<p>Nous commençons par extraire les délivrances de médicaments
antihypertenseurs en utilisant la fonction <a href="../R/extract_drug_dispenses.R:94"><code>extract_drug_dispenses()</code></a>.
Les codes ATC pour les antihypertenseurs commencent généralement par
“C02”, “C03”, “C07”, “C08”, et “C09”.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Définir la période d'étude</span></span>
<span><span class="va">start_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2020-01-01"</span><span class="op">)</span></span>
<span><span class="va">end_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2020-12-31"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Codes ATC pour les antihypertenseurs</span></span>
<span><span class="va">atc_antihypertenseurs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C02"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extraire les délivrances d'antihypertenseurs</span></span>
<span><span class="va">antihypertenseurs_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_drug_dispenses.html">extract_drug_dispenses</a></span><span class="op">(</span></span>
<span>  start_date <span class="op">=</span> <span class="va">start_date</span>,</span>
<span>  end_date <span class="op">=</span> <span class="va">end_date</span>,</span>
<span>  atc_cod_starts_with_filter <span class="op">=</span> <span class="va">atc_antihypertenseurs</span>,</span>
<span>  conn <span class="op">=</span> <span class="va">conn</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Afficher un aperçu des données</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Nombre de délivrances extraites :"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">antihypertenseurs_data</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">antihypertenseurs_data</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="étape-2-identification-des-patients-uniques">Étape 2 : Identification des patients uniques<a class="anchor" aria-label="anchor" href="#%C3%A9tape-2-identification-des-patients-uniques"></a>
</h3>
<p>À partir des délivrances, nous identifions les patients uniques et
récupérons leurs identifiants complets en utilisant <a href="../R/retrieve_patient_id.R:330"><code>retrieve_all_psa_from_psa()</code></a>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Créer une table temporaire des patients avec délivrances d'antihypertenseurs</span></span>
<span><span class="va">patients_psa</span> <span class="op">&lt;-</span> <span class="va">antihypertenseurs_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">BEN_NIR_PSA</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Sauvegarder temporairement dans Oracle</span></span>
<span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbWriteTable.html" class="external-link">dbWriteTable</a></span><span class="op">(</span><span class="va">conn</span>, <span class="st">"TMP_PATIENTS_PSA"</span>, <span class="va">patients_psa</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Récupérer tous les identifiants patients associés</span></span>
<span><span class="va">patients_identifiants</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/retrieve_all_psa_from_psa.html">retrieve_all_psa_from_psa</a></span><span class="op">(</span></span>
<span>  ben_table_name <span class="op">=</span> <span class="st">"TMP_PATIENTS_PSA"</span>,</span>
<span>  conn <span class="op">=</span> <span class="va">conn</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filtrer les patients avec des critères de qualité</span></span>
<span><span class="va">patients_qualite</span> <span class="op">&lt;-</span> <span class="va">patients_identifiants</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="op">!</span><span class="va">psa_w_multiple_idt_or_nir</span>,  <span class="co"># Éviter les PSA multiples</span></span>
<span>    <span class="va">cdi_nir_00</span>,                   <span class="co"># NIR non fictifs</span></span>
<span>    <span class="va">nir_ano_defined</span>,              <span class="co"># NIR anonyme défini</span></span>
<span>    <span class="op">!</span><span class="va">birth_date_variation</span>,        <span class="co"># Pas de variation date naissance</span></span>
<span>    <span class="op">!</span><span class="va">sex_variation</span>               <span class="co"># Pas de variation sexe</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Nombre de patients identifiés :"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">patients_qualite</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="étape-3-extraction-des-affections-de-longue-durée-ald">Étape 3 : Extraction des Affections de Longue Durée (ALD)<a class="anchor" aria-label="anchor" href="#%C3%A9tape-3-extraction-des-affections-de-longue-dur%C3%A9e-ald"></a>
</h3>
<p>Nous extrayons ensuite les ALD cardiovasculaires pour nos patients en
utilisant <a href="../R/extract_long_term_disease.R:80"><code>extract_long_term_disease()</code></a>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Codes ICD-10 pour les maladies cardiovasculaires</span></span>
<span><span class="va">icd_cardiovasculaires</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"I10"</span>, <span class="st">"I11"</span>, <span class="st">"I12"</span>, <span class="st">"I13"</span>, <span class="st">"I15"</span>, <span class="st">"I20"</span>, <span class="st">"I21"</span>, <span class="st">"I22"</span>, <span class="st">"I25"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Préparer les identifiants patients pour l'extraction</span></span>
<span><span class="va">patients_ids_filter</span> <span class="op">&lt;-</span> <span class="va">patients_qualite</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">BEN_IDT_ANO</span>, <span class="va">BEN_NIR_PSA</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extraire les ALD cardiovasculaires</span></span>
<span><span class="va">ald_cardiovasculaires</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_long_term_disease.html">extract_long_term_disease</a></span><span class="op">(</span></span>
<span>  start_date <span class="op">=</span> <span class="va">start_date</span>,</span>
<span>  end_date <span class="op">=</span> <span class="va">end_date</span>,</span>
<span>  icd_cod_starts_with <span class="op">=</span> <span class="va">icd_cardiovasculaires</span>,</span>
<span>  patients_ids <span class="op">=</span> <span class="va">patients_ids_filter</span>,</span>
<span>  conn <span class="op">=</span> <span class="va">conn</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Nombre d'ALD cardiovasculaires :"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ald_cardiovasculaires</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Analyser la répartition par type d'ALD</span></span>
<span><span class="va">ald_resume</span> <span class="op">&lt;-</span> <span class="va">ald_cardiovasculaires</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">MED_MTF_COD</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ald_resume</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="étape-4-extraction-des-séjours-hospitaliers">Étape 4 : Extraction des séjours hospitaliers<a class="anchor" aria-label="anchor" href="#%C3%A9tape-4-extraction-des-s%C3%A9jours-hospitaliers"></a>
</h3>
<p>Nous extrayons les séjours hospitaliers avec des diagnostics
cardiovasculaires en utilisant <a href="../R/extract_hospital_stays.R:216"><code>extract_hospital_stays()</code></a>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extraire les séjours avec diagnostics cardiovasculaires</span></span>
<span><span class="va">sejours_cardiovasculaires</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_hospital_stays.html">extract_hospital_stays</a></span><span class="op">(</span></span>
<span>  start_date <span class="op">=</span> <span class="va">start_date</span>,</span>
<span>  end_date <span class="op">=</span> <span class="va">end_date</span>,</span>
<span>  dp_cim10_codes_filter <span class="op">=</span> <span class="va">icd_cardiovasculaires</span>,</span>
<span>  or_dr_with_same_codes_filter <span class="op">=</span> <span class="cn">TRUE</span>,  <span class="co"># Inclure les diagnostics reliés</span></span>
<span>  patients_ids_filter <span class="op">=</span> <span class="va">patients_ids_filter</span>,</span>
<span>  conn <span class="op">=</span> <span class="va">conn</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Nombre de séjours cardiovasculaires :"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sejours_cardiovasculaires</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Analyser la durée moyenne des séjours</span></span>
<span><span class="va">duree_moyenne</span> <span class="op">&lt;-</span> <span class="va">sejours_cardiovasculaires</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    duree_moyenne <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">SEJ_NBJ</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    duree_mediane <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">SEJ_NBJ</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">duree_moyenne</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="étape-5-analyses-descriptives">Étape 5 : Analyses descriptives<a class="anchor" aria-label="anchor" href="#%C3%A9tape-5-analyses-descriptives"></a>
</h3>
<div class="section level4">
<h4 id="caractéristiques-des-patients">5.1 Caractéristiques des patients<a class="anchor" aria-label="anchor" href="#caract%C3%A9ristiques-des-patients"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Analyser l'âge des patients avec antihypertenseurs</span></span>
<span><span class="va">age_analyse</span> <span class="op">&lt;-</span> <span class="va">sejours_cardiovasculaires</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">BEN_IDT_ANO</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span>  <span class="co"># Un seul enregistrement par patient</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    age_moyen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">AGE_ANN</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    age_median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">AGE_ANN</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    age_min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">AGE_ANN</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    age_max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">AGE_ANN</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">age_analyse</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Répartition par sexe</span></span>
<span><span class="va">sexe_repartition</span> <span class="op">&lt;-</span> <span class="va">sejours_cardiovasculaires</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">BEN_IDT_ANO</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">COD_SEX</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pourcentage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">n</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sexe_repartition</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="analyses-des-délivrances">5.2 Analyses des délivrances<a class="anchor" aria-label="anchor" href="#analyses-des-d%C3%A9livrances"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Analyser les délivrances par code ATC</span></span>
<span><span class="va">delivrances_atc</span> <span class="op">&lt;-</span> <span class="va">antihypertenseurs_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">PHA_ATC_CLA</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pourcentage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">n</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">delivrances_atc</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Analyser la quantité moyenne délivrée</span></span>
<span><span class="va">quantite_analyse</span> <span class="op">&lt;-</span> <span class="va">antihypertenseurs_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    quantite_moyenne <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">PHA_ACT_QSN</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    quantite_mediane <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">PHA_ACT_QSN</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">quantite_analyse</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Évolution temporelle des délivrances</span></span>
<span><span class="va">evolution_mensuelle</span> <span class="op">&lt;-</span> <span class="va">antihypertenseurs_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>mois <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/round_date.html" class="external-link">floor_date</a></span><span class="op">(</span><span class="va">EXE_SOI_DTD</span>, <span class="st">"month"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">mois</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">mois</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">evolution_mensuelle</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="étape-6-nettoyage-et-fermeture">Étape 6 : Nettoyage et fermeture<a class="anchor" aria-label="anchor" href="#%C3%A9tape-6-nettoyage-et-fermeture"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Supprimer les tables temporaires</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbExistsTable.html" class="external-link">dbExistsTable</a></span><span class="op">(</span><span class="va">conn</span>, <span class="st">"TMP_PATIENTS_PSA"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbRemoveTable.html" class="external-link">dbRemoveTable</a></span><span class="op">(</span><span class="va">conn</span>, <span class="st">"TMP_PATIENTS_PSA"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Fermer la connexion</span></span>
<span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbDisconnect.html" class="external-link">dbDisconnect</a></span><span class="op">(</span><span class="va">conn</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Résumé de l'étude</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">=== RÉSUMÉ DE L'ÉTUDE ===</span></span>
<span><span class="st">Période analysée :"</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">start_date</span><span class="op">)</span>, <span class="st">"au"</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">end_date</span><span class="op">)</span>, <span class="st">"</span></span>
<span><span class="st">Patients avec antihypertenseurs :"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">patients_qualite</span><span class="op">)</span>, <span class="st">"</span></span>
<span><span class="st">ALD cardiovasculaires :"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ald_cardiovasculaires</span><span class="op">)</span>, <span class="st">"</span></span>
<span><span class="st">Séjours cardiovasculaires :"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sejours_cardiovasculaires</span><span class="op">)</span>, <span class="st">"</span></span>
<span><span class="st">"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h3>
<p>Ce tutoriel a présenté un exemple complet d’utilisation du package <a href="../R/"><code>sndsTools</code></a> pour analyser les données
d’antihypertenseurs dans le SNDS. Les principales étapes couvertes
incluent :</p>
<ol style="list-style-type: decimal">
<li>
<strong>Extraction des délivrances</strong> avec <a href="../R/extract_drug_dispenses.R:94"><code>extract_drug_dispenses()</code></a>
</li>
<li>
<strong>Gestion des identifiants patients</strong> avec <a href="../R/retrieve_patient_id.R:330"><code>retrieve_all_psa_from_psa()</code></a>
</li>
<li>
<strong>Extraction des ALD</strong> avec <a href="../R/extract_long_term_disease.R:80"><code>extract_long_term_disease()</code></a>
</li>
<li>
<strong>Extraction des séjours hospitaliers</strong> avec <a href="../R/extract_hospital_stays.R:216"><code>extract_hospital_stays()</code></a>
</li>
<li>
<strong>Analyses descriptives</strong> des données extraites</li>
</ol>
<div class="section level4">
<h4 id="bonnes-pratiques">Bonnes pratiques<a class="anchor" aria-label="anchor" href="#bonnes-pratiques"></a>
</h4>
<ul>
<li>Toujours utiliser des filtres de qualité sur les identifiants
patients</li>
<li>Vérifier la cohérence des dates et périodes d’extraction</li>
<li>Nettoyer les tables temporaires après utilisation</li>
<li>Fermer les connexions à la base de données</li>
</ul>
</div>
<div class="section level4">
<h4 id="fonctions-utilitaires-supplémentaires">Fonctions utilitaires supplémentaires<a class="anchor" aria-label="anchor" href="#fonctions-utilitaires-suppl%C3%A9mentaires"></a>
</h4>
<p>Le package propose également des fonctions utilitaires : - <a href="../R/utils.R:6"><code>connect_oracle()</code></a> pour la
connexion Oracle - <a href="../R/utils.R:52"><code>create_table_from_query()</code></a> pour
créer des tables à partir de requêtes - <a href="../R/utils.R:117"><code>gather_table_stats()</code></a> pour
optimiser les performances</p>
<p>Pour plus d’informations, consultez la documentation complète du
package et les exemples dans le dossier <a href="../notebooks/"><code>notebooks/</code></a>.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/abelloir-zz" class="external-link">Antoine Belloir</a>, <a href="https://info.m2dou.fr/" class="external-link">Matthieu Doutreligne</a>, <a href="https://github.com/ThomasSoeiro" class="external-link">Thomas Soeiro</a>, <a href="https://github.com/MarcDibling" class="external-link">Marc Dibling</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
